# Mysh3ll's kata sandbox ( thx to [@Maeevick](https://github.com/Maeevick))

A very simple boilerplate to have fun with kata and experiments

From [@Xnopre](https://github.com/xnopre/xnopre-katas) Katas TDD

# Calcul de prix

> Tr√®s bon sujet tr√®s simple pour d√©buter en TDD, avec des tests simples (sans mock)

G√©n√©rer une chaine de caract√®res avec le prix total √† partir des informations suivantes :

- Nombre d'articles
- Prix unitaire
- Taxe

Exemples chiffr√©es :

- 3 articles √† 1,21 ‚Ç¨ et taxe 0 % ‚Üí ‚Äú3.63 ‚Ç¨‚Äù
- 3 articles √† 1,21 ‚Ç¨ et taxe 5 % ‚Üí ‚Äú3.81 ‚Ç¨‚Äù
- 3 articles √† 1,21 ‚Ç¨ et taxe 20 % ‚Üí ‚Äú4.36 ‚Ç¨‚Äù

Puis on ajoute des r√©ductions si le prix total d√©pense un seuil :

- 1000 ‚Ç¨ ‚Üí Remise 3% :
  - Ex : 5 x 345,00 ‚Ç¨ + taxe 10% ‚Üí ‚Äú1840.58 ‚Ç¨‚Äù
- 5000 ‚Ç¨ ‚Üí Remise 5% :
  - Ex : 5 x 1299,00 ‚Ç¨ + taxe 10% ‚Üí ‚Äú6787.28 ‚Ç¨‚Äù

## Tips si tu d√©butes en TDD

- Chaque exemple chiffr√© ci-dessus peut correspondre √† un test
- Mettre en place une impl√©mentation la plus simple possible (une fonction ou une classe et une fonction devrait
  suffire)
- Toujours impl√©menter le strict minium ("en toute intelligence" üòâ) pour faire passer chaque test

Mieux vaut essayer et chercher par toi m√™me, mais tu peux trouver des solutions, ou au moins des contextes et
outillage, [sur ce d√©p√¥t xnopre/tdd-demos](https://github.com/xnopre/tdd-demos).

### Requirements

- _With Docker_
    - make
    - docker && docker-compose
- _Without Docker_
    - node
    - npm/yarn

:arrow_right: **Note**: you could run the commands with `npm` or `make` with docker-compose. _Make_ raises the container with docker-compose, executes the task and removes the container.

### Main scripts

:warning: **Warning**: we decided to switch from yarn 1.22 to npm due to problems to manage dependencies between Jest 27 and Stryker 5

:arrow_right: **Obvious Note**: require to install dependencies
```shell
npm i
or
make install
```
- **execute a typescript program / file** (_works on javascript program too_) 
```shell
npm run start [your file/entry point]

npm run start src/pricer.ts # for example
or
make start ARGS="src/pricer.ts"
```

- **execute all tests files once** 
```shell
npm run test
or
make test
```

- **execute all tests files** (_impacted by changes_) **in watch mode** (a.k.a. on save) 
```shell
npm run test:watch
or
make test-watch
```

- **execute mutation testing** 
```shell
npm run test:mutate
or
make test-mutate
```
:arrow_right: **Note**: configured with very high threshold, you can change them in : `stryker.conf.json`

- **execute all the CI's workflow** (tsc for transpilation, eslint for linter, test:coverage and test:mutate) 
```shell
npm run ci
or
make ci
```

:warning: **Warning**: Mutation Testing may be very time consuming

### Reports

- **traditional coverage report generated by** `jest` **is in** `/reports/coverage/lcov-report/`

:warning: **Warning**: Coverage report is not 100% trustable, as you may know, it displays only the code covered by execution, **coverage doesn't mean : this code is tested, it means this code has been executed during tests !!**

- **mutation testing report generated by** `stryker` **is in** `/reports/mutation/html/`

:warning: **Warning**: Mutation testing challenges your tests and your coverage, report is more relevant than "traditional coverage" however it's not silver bullet (read documentation [here](https://stryker-mutator.io/) about limitations)

- **train your Test-Driven Development techniques**, step by step you will need less and less Coverage and Mutation Testing because **great TDD (_and TCR_) is best way to have only useful tested code in a fast and trustable manner.** 

### Linter

- Eslint uses mainly the `standard` and `recommended` set of rules, with few personnal preferences, feel free to change it in : `.eslintrc.json` to be confortable.

- **execute eslint check** 
```shell
npm run lint:check
or
make lint-check
```

- **execute eslint fix** 
```shell
npm run lint:fix
or
make lint-fix
```

:warning: **Warning**: If you execute the command `make test-watch` make sure to exit with the `q` and not with `Ctrl C`, otherwise the docker container will not be destroyed.
